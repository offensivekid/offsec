<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN CONTROL</title>
    <link rel="stylesheet" href="/admin/admin.css">
</head>
<body>
    <div class="background-grid"></div>
    <div class="cursor-glow"></div>
    <div class="scan-line"></div>
    
    <div class="loading-screen" id="loadingScreen">
        <div class="loader"></div>
        <div class="loading-text">INITIALIZING SYSTEM</div>
    </div>

    <header>
        <div class="container">
            <div class="header-top">
                <div class="logo">
                    <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
                        <circle cx="12" cy="12" r="3"/>
                    </svg>
                    <span>ADMIN CONTROL</span>
                    <div class="status-indicator"></div>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                        <polyline points="16 17 21 12 16 7"/>
                        <line x1="21" y1="12" x2="9" y2="12"/>
                    </svg>
                    LOGOUT
                </button>
            </div>
            
            <nav class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('dashboard')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"/>
                        <rect x="14" y="3" width="7" height="7"/>
                        <rect x="14" y="14" width="7" height="7"/>
                        <rect x="3" y="14" width="7" height="7"/>
                    </svg>
                    <span>DASHBOARD</span>
                </button>
                <button class="nav-tab" onclick="showSection('users')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                        <circle cx="9" cy="7" r="4"/>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                    </svg>
                    <span>USERS</span>
                </button>
                <button class="nav-tab" onclick="showSection('content')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                    </svg>
                    <span>CONTENT</span>
                </button>
                <button class="nav-tab" onclick="showSection('keys')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                    </svg>
                    <span>KEYS</span>
                </button>
                <button class="nav-tab" onclick="showSection('siem')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
                    </svg>
                    <span>SIEM</span>
                </button>
                <button class="nav-tab" onclick="showSection('ipbans')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
                    </svg>
                    <span>IP BANS</span>
                </button>
                <button class="nav-tab" onclick="showSection('settings')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                    <span>SETTINGS</span>
                </button>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="9" cy="7" r="4"/>
                            </svg>
                            <div class="stat-label">Total Users</div>
                        </div>
                        <div class="stat-value" id="totalUsers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                            </svg>
                            <div class="stat-label">Total Threads</div>
                        </div>
                        <div class="stat-value" id="totalThreads">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                            </svg>
                            <div class="stat-label">Total Replies</div>
                        </div>
                        <div class="stat-value" id="totalReplies">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                            <div class="stat-label">Active Keys</div>
                        </div>
                        <div class="stat-value" id="activeKeys">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="15" y1="9" x2="9" y2="15"/>
                                <line x1="9" y1="9" x2="15" y2="15"/>
                            </svg>
                            <div class="stat-label">Banned Users</div>
                        </div>
                        <div class="stat-value" id="bannedUsers">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <svg class="stat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                <line x1="12" y1="9" x2="12" y2="13"/>
                                <line x1="12" y1="17" x2="12.01" y2="17"/>
                            </svg>
                            <div class="stat-label">Critical Events</div>
                        </div>
                        <div class="stat-value" id="siemCritical">0</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                            </svg>
                            RECENT EVENTS
                        </div>
                    </div>
                    <div id="recentSiem"></div>
                </div>
            </div>

            <!-- Users Section -->
            <div id="users" class="section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="9" cy="7" r="4"/>
                            </svg>
                            USER MANAGEMENT
                        </div>
                        <button class="btn" onclick="showModal('createUserModal')">CREATE USER</button>
                    </div>
                    <div id="usersTable"></div>
                </div>
            </div>

            <!-- Content Section -->
            <div id="content" class="section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                            </svg>
                            CONTENT MODERATION
                        </div>
                    </div>
                    <div id="threadsTable"></div>
                </div>
            </div>

            <!-- Keys Section -->
            <div id="keys" class="section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                            </svg>
                            GENERATE KEYS
                        </div>
                    </div>
                    <div style="display: flex; gap: 15px; align-items: flex-end; margin-bottom: 20px;">
                        <div class="form-group" style="flex: 1; margin: 0;">
                            <label>Count</label>
                            <input type="number" id="keyCount" min="1" max="50" value="1">
                        </div>
                        <button class="btn" onclick="generateKeys()">GENERATE</button>
                    </div>
                    <div id="generatedKeys"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                            ALL KEYS
                        </div>
                    </div>
                    <div id="keysTable"></div>
                </div>
            </div>

            <!-- SIEM Section -->
            <div id="siem" class="section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
                            </svg>
                            SIEM MONITOR
                        </div>
                        <button class="btn-secondary btn" onclick="purgeSiem()">PURGE LOGS</button>
                    </div>
                    <div class="filters">
                        <select id="severityFilter" onchange="loadSiem()">
                            <option value="">ALL SEVERITIES</option>
                            <option value="critical">CRITICAL</option>
                            <option value="high">HIGH</option>
                            <option value="medium">MEDIUM</option>
                            <option value="low">LOW</option>
                        </select>
                        <input type="text" id="eventTypeFilter" placeholder="EVENT TYPE..." style="width: 250px;">
                        <button class="btn-secondary btn btn-small" onclick="loadSiem()">FILTER</button>
                    </div>
                    <div id="siemLogs"></div>
                    <div class="pagination" id="siemPagination"></div>
                </div>
            </div>

            <!-- IP Bans Section -->
            <div id="ipbans" class="section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
                            </svg>
                            IP BAN MANAGEMENT
                        </div>
                        <button class="btn" onclick="showModal('createBanModal')">BAN IP</button>
                    </div>
                    <div id="ipbansTable"></div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settings" class="section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"/>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                            </svg>
                            CHANGE PASSWORD
                        </div>
                    </div>
                    <form onsubmit="changePassword(event)">
                        <div class="form-group">
                            <label>Current Password</label>
                            <input type="password" id="currentPassword" required>
                        </div>
                        <div class="form-group">
                            <label>New Password</label>
                            <input type="password" id="newPassword" required minlength="8">
                        </div>
                        <button type="submit" class="btn">UPDATE PASSWORD</button>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <div class="modal" id="createUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">CREATE USER</div>
                <button class="close-btn" onclick="closeModal('createUserModal')">×</button>
            </div>
            <form onsubmit="createUser(event)">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="newUsername" required minlength="3" maxlength="50">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="newEmail" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="newPassword" required minlength="8">
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="newIsAdmin">
                    <label for="newIsAdmin">Admin</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="newHasPrivateAccess">
                    <label for="newHasPrivateAccess">Private Access</label>
                </div>
                <button type="submit" class="btn" style="width: 100%; margin-top: 20px;">CREATE</button>
            </form>
        </div>
    </div>

    <div class="modal" id="createBanModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">BAN IP ADDRESS</div>
                <button class="close-btn" onclick="closeModal('createBanModal')">×</button>
            </div>
            <form onsubmit="createIPBan(event)">
                <div class="form-group">
                    <label>IP Address</label>
                    <input type="text" id="banIP" required pattern="^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$" placeholder="192.168.1.1">
                </div>
                <div class="form-group">
                    <label>Reason</label>
                    <input type="text" id="banReason" placeholder="Optional">
                </div>
                <div class="form-group">
                    <label>Duration</label>
                    <select id="banDuration">
                        <option value="">Permanent</option>
                        <option value="3600000">1 Hour</option>
                        <option value="86400000">24 Hours</option>
                        <option value="604800000">7 Days</option>
                        <option value="2592000000">30 Days</option>
                    </select>
                </div>
                <button type="submit" class="btn" style="width: 100%; margin-top: 20px;">BAN</button>
            </form>
        </div>
    </div>

    <script src="/admin/admin.js"></script>
</body>
</html>
